{"version":3,"file":"find-issue-key-execute.js","sources":["../src/actions/find-issue-key/find-issue-key-execute.ts"],"sourcesContent":["import Jira from '../../services/jira'\nimport getGithubEvent from '../../utils/get-github-event'\nimport preprocessString from '../../utils/preprocess-string'\n\nconst issueIdRegEx = /([a-zA-Z0-9]+-[0-9]+)/g\n\nasync function execute(config, inputString: string) {\n  const githubEvent = getGithubEvent()\n\n  const jiraInstance = new Jira({\n    baseUrl: config.baseUrl,\n    email: config.email,\n    token: config.token\n  })\n\n  const extractString = preprocessString(inputString, githubEvent)\n  const match = extractString.match(issueIdRegEx)\n\n  if (!match) {\n    console.log(`String \"${extractString}\" does not contain issueKeys`)\n\n    return\n  }\n\n  const issues: string[] = []\n\n  for (const issueKey of match) {\n    const response = await jiraInstance.getIssue(issueKey)\n\n    if (response.status === 200) {\n      issues.push(response.data.key as string)\n    }\n  }\n\n  return issues.length > 0 ? [...new Set(issues)].join(', ') : null\n}\n\nexport default execute\n"],"names":["Jira"],"mappings":";;;;;;;;;;;;;;;;;;;;AAIA,MAAM,YAAY,GAAG,wBAAwB,CAAA;AAE7C,eAAe,OAAO,CAAC,MAAM,EAAE,WAAmB,EAAA;AAChD,IAAA,MAAM,WAAW,GAAG,cAAc,EAAE,CAAA;AAEpC,IAAA,MAAM,YAAY,GAAG,IAAIA,IAAI,CAAC;QAC5B,OAAO,EAAE,MAAM,CAAC,OAAO;QACvB,KAAK,EAAE,MAAM,CAAC,KAAK;QACnB,KAAK,EAAE,MAAM,CAAC,KAAK;AACpB,KAAA,CAAC,CAAA;IAEF,MAAM,aAAa,GAAG,gBAAgB,CAAC,WAAW,EAAE,WAAW,CAAC,CAAA;IAChE,MAAM,KAAK,GAAG,aAAa,CAAC,KAAK,CAAC,YAAY,CAAC,CAAA;IAE/C,IAAI,CAAC,KAAK,EAAE;AACV,QAAA,OAAO,CAAC,GAAG,CAAC,WAAW,aAAa,CAAA,4BAAA,CAA8B,CAAC,CAAA;QAEnE,OAAM;AACP,KAAA;IAED,MAAM,MAAM,GAAa,EAAE,CAAA;AAE3B,IAAA,KAAK,MAAM,QAAQ,IAAI,KAAK,EAAE;QAC5B,MAAM,QAAQ,GAAG,MAAM,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAA;AAEtD,QAAA,IAAI,QAAQ,CAAC,MAAM,KAAK,GAAG,EAAE;YAC3B,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAa,CAAC,CAAA;AACzC,SAAA;AACF,KAAA;IAED,OAAO,MAAM,CAAC,MAAM,GAAG,CAAC,GAAG,CAAC,GAAG,IAAI,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,IAAI,CAAA;AACnE;;;;"}