{"version":3,"file":"comment-execute.js","sources":["../src/actions/comment/comment-execute.ts"],"sourcesContent":["import _ from 'lodash'\n\nimport Jira from '../../services/jira'\nimport getGithubEvent from '../../utils/get-github-event'\nimport mdToAdf from '../../utils/md-to-adf'\n\nasync function execute(config, rawComment: string) {\n  const githubEvent = getGithubEvent()\n\n  const jiraInstance = new Jira({\n    baseUrl: config.baseUrl,\n    email: config.email,\n    token: config.token\n  })\n\n  const issueKey: string = config.issue\n\n  _.templateSettings.interpolate = /{{([\\s\\S]+?)}}/g\n  const compiled = _.template(rawComment)\n  const interpolatedComment = compiled({event: githubEvent})\n\n  const comment = mdToAdf(interpolatedComment)\n\n  await jiraInstance.addComment(\n    issueKey,\n    JSON.stringify({\n      body: comment\n    })\n  )\n\n  console.log(`Comment has been added to ${issueKey}: ${interpolatedComment}`)\n}\n\nexport default execute\n"],"names":["Jira","_"],"mappings":";;;;;;;;;;;;;;;;AAMA,eAAe,OAAO,CAAC,MAAM,EAAE,UAAkB,EAAA;AAC/C,IAAA,MAAM,WAAW,GAAG,cAAc,EAAE,CAAA;AAEpC,IAAA,MAAM,YAAY,GAAG,IAAIA,IAAI,CAAC;QAC5B,OAAO,EAAE,MAAM,CAAC,OAAO;QACvB,KAAK,EAAE,MAAM,CAAC,KAAK;QACnB,KAAK,EAAE,MAAM,CAAC,KAAK;AACpB,KAAA,CAAC,CAAA;AAEF,IAAA,MAAM,QAAQ,GAAW,MAAM,CAAC,KAAK,CAAA;AAErC,IAAAC,QAAC,CAAC,gBAAgB,CAAC,WAAW,GAAG,iBAAiB,CAAA;IAClD,MAAM,QAAQ,GAAGA,QAAC,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAA;IACvC,MAAM,mBAAmB,GAAG,QAAQ,CAAC,EAAC,KAAK,EAAE,WAAW,EAAC,CAAC,CAAA;AAE1D,IAAA,MAAM,OAAO,GAAG,OAAO,CAAC,mBAAmB,CAAC,CAAA;IAE5C,MAAM,YAAY,CAAC,UAAU,CAC3B,QAAQ,EACR,IAAI,CAAC,SAAS,CAAC;AACb,QAAA,IAAI,EAAE,OAAO;AACd,KAAA,CAAC,CACH,CAAA;IAED,OAAO,CAAC,GAAG,CAAC,CAAA,0BAAA,EAA6B,QAAQ,CAAK,EAAA,EAAA,mBAAmB,CAAE,CAAA,CAAC,CAAA;AAC9E;;;;"}